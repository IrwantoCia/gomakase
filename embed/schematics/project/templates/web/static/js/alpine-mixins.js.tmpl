// alpine-mixins.js
import { apiFetch } from './api.js';

// A reusable "mixin" that provides loading state and a smart fetch method
export function withApi() {
    return {
        /**
         * A wrapper method to perform an API call.
         * It automatically handles loading states and shows notifications.
         * @param {Function} apiCall - An async function that performs the apiFetch.
         */
        async handleApiCall(apiCall) {
            // Use Alpine's global store, accessible via the window object here
            const notifications = Alpine.store('notifications'); 

            try {
                const result = await apiCall();
                // Optionally show a success message
                // notifications.show('Operation successful!', 'success');
                return result;
            } catch (error) {
                console.error('API Call Failed:', error);
                notifications.show(error.message || 'An unexpected error occurred.', 'error');
            }
        }
    }
};
